@page
@model EnrollmentSystem.Pages.Admin.Vehicles.DeleteModel
@{
    ViewData["Title"] = "Delete Vehicle";
}

<h2 class="text-danger"><i class="bi bi-exclamation-triangle me-2"></i>Delete Vehicle</h2>

@if (Model.HasDependencies)
{
    <div class="alert alert-danger">
        <h5><i class="bi bi-exclamation-circle me-2"></i>Warning: This vehicle has dependencies</h5>
        <p>This vehicle cannot be deleted because it has associated records:</p>
        <ul>
            @if (Model.ScheduleCount > 0)
            {
                <li><strong>@Model.ScheduleCount</strong> schedule(s)</li>
            }
            @if (Model.MaintenanceCount > 0)
            {
                <li><strong>@Model.MaintenanceCount</strong> maintenance record(s)</li>
            }
        </ul>
        <p class="mb-0">Please remove or reassign the associated schedules before deleting this vehicle. Maintenance records will be deleted automatically.</p>
    </div>
}
else
{
    <div class="alert alert-warning">
        <p><i class="bi bi-info-circle me-2"></i><strong>Are you sure you want to delete this vehicle?</strong></p>
        <p class="mb-0">This action cannot be undone. All maintenance records will be permanently deleted.</p>
    </div>
}

<div class="card">
    <div class="card-header">
        <h5 class="mb-0">Vehicle Information</h5>
    </div>
    <div class="card-body">
        <dl class="row">
            <dt class="col-sm-3">Vehicle</dt>
            <dd class="col-sm-9">@Model.Vehicle.Year @Model.Vehicle.Make @Model.Vehicle.Model</dd>

            <dt class="col-sm-3">License Plate</dt>
            <dd class="col-sm-9"><span class="badge bg-secondary">@Model.Vehicle.LicensePlate</span></dd>

            <dt class="col-sm-3">VIN</dt>
            <dd class="col-sm-9"><code>@Model.Vehicle.VIN</code></dd>

            <dt class="col-sm-3">Type</dt>
            <dd class="col-sm-9">@Model.Vehicle.Type</dd>

            <dt class="col-sm-3">Transmission</dt>
            <dd class="col-sm-9">@Model.Vehicle.Transmission</dd>

            <dt class="col-sm-3">Current Mileage</dt>
            <dd class="col-sm-9">@Model.Vehicle.CurrentMileage.ToString("N0") miles</dd>

            <dt class="col-sm-3">Status</dt>
            <dd class="col-sm-9">
                @switch (Model.Vehicle.Status)
                {
                    case EnrollmentSystem.Models.VehicleStatus.Available:
                        <span class="badge bg-success">Available</span>
                        break;
                    case EnrollmentSystem.Models.VehicleStatus.InUse:
                        <span class="badge bg-warning text-dark">In Use</span>
                        break;
                    case EnrollmentSystem.Models.VehicleStatus.Maintenance:
                        <span class="badge bg-danger">Maintenance</span>
                        break;
                    case EnrollmentSystem.Models.VehicleStatus.OutOfService:
                        <span class="badge bg-dark">Out of Service</span>
                        break;
                    case EnrollmentSystem.Models.VehicleStatus.Retired:
                        <span class="badge bg-secondary">Retired</span>
                        break;
                }
            </dd>

            @if (Model.Vehicle.Location != null)
            {
                <dt class="col-sm-3">Location</dt>
                <dd class="col-sm-9">@Model.Vehicle.Location.Name</dd>
            }
        </dl>
    </div>
</div>

<form method="post" class="mt-3">
    <input type="hidden" asp-for="Vehicle.Id" />
    <div class="d-flex justify-content-between">
        <a asp-page="./Index" class="btn btn-secondary">
            <i class="bi bi-arrow-left me-1"></i>Cancel
        </a>
        @if (!Model.HasDependencies)
        {
            <button type="submit" class="btn btn-danger">
                <i class="bi bi-trash me-1"></i>Delete Vehicle
            </button>
        }
        else
        {
            <button type="button" class="btn btn-danger" disabled>
                <i class="bi bi-trash me-1"></i>Cannot Delete (Has Dependencies)
            </button>
        }
    </div>
</form>
